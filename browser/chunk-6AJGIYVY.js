import{a as ge,b as Ce,c as Pe,e as De,g as Me,h as Te,k as Be,l as Ne,m as $e}from"./chunk-45WKQC3B.js";import{a as N,b as de,d as _e,f as ve,g as ue,r as we}from"./chunk-ZL6F2LW5.js";import{a as ye,c as he,d as Se,e as xe,f as Oe,g as Ie,h as Ee,k as Re,l as ke,n as Fe}from"./chunk-O7BT5NGP.js";import{a as be}from"./chunk-YEIIAXXN.js";import{$ as h,$a as le,Ab as T,Ba as ee,Ca as te,Da as ie,Ea as W,Fa as s,Ga as x,Ha as u,Ia as z,Ka as re,Kb as B,La as ne,Lb as fe,Ma as oe,Q as k,Qa as c,R as F,Ra as w,S as X,Sa as O,Xa as ae,Za as M,_a as se,aa as a,ab as pe,bc as ce,ca as S,da as d,e as j,hb as me,ia as f,k as q,ka as J,la as m,ma as P,na as K,q as y,qa as _,r as Q,ra as D,sa as g,ta as C,ua as r,v as Y,va as n,wa as p,xa as Z,ya as H,za as b}from"./chunk-RW7BJWYE.js";function Ue(t,i){t&1&&(r(0,"span",4),s(1," Pro "),n())}function Ve(t,i){if(t&1&&(r(0,"div",0)(1,"div",1),p(2,"img",2),n(),r(3,"span",3),s(4),n(),f(5,Ue,2,0,"span",4),n()),t&2){let e=b();a(),K("offer__avatar-wrapper--pro",e.hostUser.isPro),a(),m("src",e.hostUser.avatarUrl,h)("alt",e.hostUser.name),a(2),u(" ",e.hostUser.name," "),a(),_(e.hostUser.isPro?5:-1)}}var $=class t{hostUser={avatarUrl:"",id:1,isPro:!1,name:""};static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-host-user"]],inputs:{hostUser:"hostUser"},decls:1,vars:1,consts:[[1,"offer__host-user","user"],[1,"offer__avatar-wrapper","user__avatar-wrapper"],["width","74","height","74",1,"offer__avatar","user__avatar",3,"src","alt"],[1,"offer__user-name"],[1,"offer__user-status"]],template:function(e,o){e&1&&f(0,Ve,6,6,"div",0),e&2&&_(o.hostUser?0:-1)},encapsulation:2})};var Le=(t,i)=>i.id;function Ge(t,i){if(t&1&&p(0,"app-offer-card",3),t&2){let e=i.$implicit;m("offer",e)("block","near-places")}}var A=class t{nearbyOffers=[];displayedOffers=ae(()=>this.nearbyOffers.slice(0,B));static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-near-places-block"]],inputs:{nearbyOffers:"nearbyOffers"},decls:6,vars:0,consts:[[1,"near-places","places"],[1,"near-places__title"],[1,"near-places__list","places__list"],[3,"offer","block"]],template:function(e,o){e&1&&(r(0,"section",0)(1,"h2",1),s(2,"Other places in the neighbourhood"),n(),r(3,"div",2),g(4,Ge,1,2,"app-offer-card",3,Le),n()()),e&2&&(a(4),C(o.displayedOffers()))},dependencies:[we],encapsulation:2})};function He(t,i){if(t&1&&(r(0,"div",2),p(1,"img",3),n()),t&2){let e=i.$implicit;a(),m("src",e,h)}}var U=class t{offerImages=[];static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-offer-gallery"]],inputs:{offerImages:"offerImages"},decls:4,vars:0,consts:[[1,"offer__gallery-container","container"],[1,"offer__gallery"],[1,"offer__image-wrapper"],["alt","Photo studio",1,"offer__image",3,"src"]],template:function(e,o){e&1&&(r(0,"div",0)(1,"div",1),g(2,He,2,1,"div",2,D),n()()),e&2&&(a(2),C(o.offerImages))},encapsulation:2})};var We=["reviewForm"],ze=(t,i)=>i.value;function je(t,i){if(t&1&&(p(0,"input",10),r(1,"label",11),X(),r(2,"svg",12),p(3,"use",13),n()()),t&2){let e=i.$implicit;m("value",e.value)("id",`${e.value}-stars`),a(),m("for",`${e.value}-stars`)("title",e.title)}}var V=class t{form;reviewFormData={rating:0,review:""};ratingMap=[{title:"perfect",value:5},{title:"good",value:4},{title:"not bad",value:3},{title:"badly",value:2},{title:"terribly",value:1}];onSubmit(){this.reviewFormData=this.form?.value}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-review-form"]],viewQuery:function(e,o){if(e&1&&ee(We,5),e&2){let l;te(l=ie())&&(o.form=l.first)}},decls:19,vars:2,consts:[["reviewForm","ngForm"],["action","#","method","post",1,"reviews__form","form",3,"ngSubmit"],["for","review",1,"reviews__label","form__label"],[1,"reviews__rating-form","form__rating"],["id","review","name","review","placeholder","Tell how was your stay, what you like and what can be improved","minlength","50","required","",1,"reviews__textarea","form__textarea",3,"ngModelChange","ngModel"],[1,"reviews__button-wrapper"],[1,"reviews__help"],[1,"reviews__star"],[1,"reviews__text-amount"],["type","submit",1,"reviews__submit","form__submit","button",3,"click","disabled"],["name","rating","type","radio","ngModel","","required","",1,"form__rating-input","visually-hidden",3,"value","id"],[1,"reviews__rating-label","form__rating-label",3,"for","title"],["width","37","height","33",1,"form__star-image"],[0,"xlink","href","#icon-star"]],template:function(e,o){if(e&1){let l=Z();r(0,"form",1,0),H("ngSubmit",function(){return k(l),F(o.onSubmit())}),r(2,"label",2),s(3,"Your review"),n(),r(4,"div",3),g(5,je,4,4,null,null,ze),n(),r(7,"textarea",4),oe("ngModelChange",function(R){return k(l),ne(o.reviewFormData.review,R)||(o.reviewFormData.review=R),F(R)}),n(),r(8,"div",5)(9,"p",6),s(10," To submit review please make sure to set "),r(11,"span",7),s(12,"rating"),n(),s(13," and describe your stay with at least "),r(14,"b",8),s(15,"50 characters"),n(),s(16,". "),n(),r(17,"button",9),H("click",function(){k(l);let R=W(1);return F(R.reset({rating:0,review:""}))}),s(18,"Submit"),n()()()}if(e&2){let l=W(1);a(5),C(o.ratingMap),a(2),re("ngModel",o.reviewFormData.review),a(10),m("disabled",!l.valid)}},dependencies:[Fe,Ie,ye,Ee,he,Se,Re,ke,Oe,xe],encapsulation:2})};var L=class t{review=null;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-review-item"]],inputs:{review:"review"},decls:19,vars:16,consts:[[1,"reviews__item"],[1,"reviews__user","user"],[1,"reviews__avatar-wrapper","user__avatar-wrapper"],["width","54","height","54",1,"reviews__avatar","user__avatar",3,"src","alt"],[1,"reviews__user-name"],[1,"reviews__info"],[1,"reviews__rating","rating"],[1,"reviews__stars","rating__stars"],[1,"visually-hidden"],[1,"reviews__text"],[1,"reviews__time"]],template:function(e,o){e&1&&(r(0,"li",0)(1,"div",1)(2,"div",2),p(3,"img",3),n(),r(4,"span",4),s(5),n()(),r(6,"div",5)(7,"div",6)(8,"div",7),p(9,"span"),c(10,"getRating"),r(11,"span",8),s(12,"Rating"),n()()(),r(13,"p",9),s(14),n(),r(15,"time",10),c(16,"date"),s(17),c(18,"date"),n()()()),e&2&&(a(3),m("src",o.review==null||o.review.user==null?null:o.review.user.avatarUrl,h)("alt",o.review==null||o.review.user==null?null:o.review.user.name),a(2),u(" ",o.review==null||o.review.user==null?null:o.review.user.name," "),a(4),P("width",w(10,8,o.review==null?null:o.review.rating)),a(5),u(" ",o.review==null?null:o.review.comment," "),a(),J("datetime",O(16,10,o.review==null?null:o.review.date,"yyyy-MM-dd")),a(2),x(O(18,13,o.review==null?null:o.review.date,"MMMM y")))},dependencies:[N,le],encapsulation:2})};var Qe=(t,i)=>i.id;function Ye(t,i){if(t&1&&p(0,"app-review-item",4),t&2){let e=i.$implicit;m("review",e)}}function Xe(t,i){if(t&1&&(r(0,"ul",3),g(1,Ye,1,1,"app-review-item",4,Qe),n()),t&2){let e=b();a(),C(e)}}function Je(t,i){if(t&1&&(r(0,"section",0)(1,"h2",1),s(2,"Reviews \xB7 "),r(3,"span",2),s(4),n()(),f(5,Xe,3,0,"ul",3),p(6,"app-review-form"),n()),t&2){let e=i,o=b();a(4),x(e.length>10?`${o.reviewsToShow} of ${e.length}`:e.length),a(),_(e.length?5:-1)}}var G=class t{constructor(i,e){this.store=i;this.reviewsService=e;this.reviews$=this.store.select(De)}offerId;reviews$;reviewsToShow=fe;ngOnInit(){this.loadSortedReviews()}loadSortedReviews(){this.reviews$=this.reviewsService.getReviews(this.offerId).pipe(y(i=>[...i].sort(_e)))}static \u0275fac=function(e){return new(e||t)(S(T),S(Pe))};static \u0275cmp=d({type:t,selectors:[["app-reviews-block"]],inputs:{offerId:"offerId"},decls:2,vars:3,consts:[[1,"offer__reviews","reviews"],[1,"reviews__title"],[1,"reviews__amount"],[1,"reviews__list"],[3,"review"]],template:function(e,o){if(e&1&&(f(0,Je,7,2,"section",0),c(1,"async")),e&2){let l;_((l=w(1,1,o.reviews$))?0:-1,l)}},dependencies:[L,V,M],encapsulation:2})};function Ke(t,i){t&1&&p(0,"app-loader")}function Ze(t,i){t&1&&p(0,"app-premium-mark",6),t&2&&m("block","offer")}function et(t,i){if(t&1&&(r(0,"li",24),s(1),n()),t&2){let e=i.$implicit;a(),u(" ",e," ")}}function tt(t,i){if(t&1&&p(0,"app-reviews-block",30),t&2){let e=b(3);m("offerId",e.offerId)}}function it(t,i){if(t&1&&p(0,"app-map",31),t&2){let e=b();m("offers",i)("city",e.city.location)("activeOfferId",e.id)}}function rt(t,i){t&1&&(r(0,"div",32),p(1,"app-near-places-block",33),n()),t&2&&(a(),m("nearbyOffers",i))}function nt(t,i){if(t&1&&(r(0,"main",0)(1,"section",2),p(2,"app-offer-gallery",3),r(3,"div",4)(4,"div",5),f(5,Ze,1,1,"app-premium-mark",6),r(6,"div",7)(7,"h1",8),s(8),n(),p(9,"app-bookmark-button",9),n(),r(10,"div",10)(11,"div",11),p(12,"span"),c(13,"getRating"),r(14,"span",12),s(15,"Rating"),n()(),r(16,"span",13),s(17),n()(),r(18,"ul",14)(19,"li",15),s(20),c(21,"titlecase"),n(),r(22,"li",16),s(23),c(24,"pluralEnding"),n(),r(25,"li",17),s(26),c(27,"pluralEnding"),n()(),r(28,"div",18)(29,"b",19),s(30),n(),r(31,"span",20),s(32,"\xA0night"),n()(),r(33,"div",21)(34,"h2",22),s(35,"What's inside"),n(),r(36,"ul",23),g(37,et,2,1,"li",24,D),n()(),r(39,"div",25)(40,"h2",26),s(41,"Meet the host"),n(),p(42,"app-host-user",27),r(43,"div",28)(44,"p",29),s(45),n()()(),f(46,tt,1,1,"app-reviews-block",30),n()(),f(47,it,1,3,"app-map",31),c(48,"async"),n(),f(49,rt,2,1,"div",32),c(50,"async"),n()),t&2){let e,o,l=i,v=b(2);a(2),m("offerImages",l.images),a(3),_(l.isPremium?5:-1),a(3),u(" ",l.title," "),a(),m("block","offer")("size","large")("isFavorite",l.isFavorite),a(3),P("width",w(13,20,l.rating)),a(5),x(l.rating),a(3),u(" ",w(21,22,l.type)," "),a(3),z(" ",l.bedrooms," ",O(24,24,"Bedroom",l.bedrooms)," "),a(3),z(" Max ",l.maxAdults," ",O(27,27,"adult",l.maxAdults)," "),a(4),u("\u20AC",l.price,""),a(7),C(l.goods),a(5),m("hostUser",l.host),a(3),u(" ",l.description," "),a(),_(v.offerId?46:-1),a(),_((e=w(48,30,v.offersForMap$))?47:-1,e),a(2),_((o=w(50,32,v.nearbyOffers$))?49:-1,o)}}function ot(t,i){t&1&&p(0,"app-not-found-block",1),t&2&&m("type","offer")}function at(t,i){if(t&1&&(f(0,nt,51,34,"main",0),c(1,"async"),f(2,ot,1,1,"app-not-found-block",1)),t&2){let e,o=b();_((e=w(1,1,o.currentOffer$))?0:2,e)}}var Ae=class t{constructor(i,e){this.route=i;this.store=e;this.currentOffer$=this.store.select(Be),this.nearbyOffers$=this.store.select(Ne),this.isLoading$=this.store.select($e),this.offersForMap$=Q([this.currentOffer$,this.nearbyOffers$.pipe(y(o=>o.slice(0,B)))]).pipe(y(([o,l])=>{let v=[];return o&&v.push(o),v=v.concat(l),v}))}offerId="";currentOffer$;combinedOffers$=q;nearbyOffers$;isLoading$;offersForMap$;subscription=new j;ngOnInit(){this.subscription=this.route.paramMap.pipe(Y(i=>!!i.get("offerId")),y(i=>i.get("offerId")??"")).subscribe(i=>{this.offerId=i,this.store.dispatch(Me({id:i})),this.store.dispatch(Te({id:i}))})}ngOnDestroy(){this.subscription.unsubscribe()}static \u0275fac=function(e){return new(e||t)(S(me),S(T))};static \u0275cmp=d({type:t,selectors:[["app-offer-page"]],decls:4,vars:3,consts:[[1,"page__main","page__main--offer"],[3,"type"],[1,"offer"],[3,"offerImages"],[1,"offer__container","container"],[1,"offer__wrapper"],[3,"block"],[1,"offer__name-wrapper"],[1,"offer__name"],[3,"block","size","isFavorite"],[1,"offer__rating","rating"],[1,"offer__stars","rating__stars"],[1,"visually-hidden"],[1,"offer__rating-value","rating__value"],[1,"offer__features"],[1,"offer__feature","offer__feature--entire"],[1,"offer__feature","offer__feature--bedrooms"],[1,"offer__feature","offer__feature--adults"],[1,"offer__price"],[1,"offer__price-value"],[1,"offer__price-text"],[1,"offer__inside"],[1,"offer__inside-title"],[1,"offer__inside-list"],[1,"offer__inside-item"],[1,"offer__host"],[1,"offer__host-title"],[3,"hostUser"],[1,"offer__description"],[1,"offer__text"],[3,"offerId"],["block","offer",3,"offers","city","activeOfferId"],[1,"container"],[3,"nearbyOffers"]],template:function(e,o){e&1&&(r(0,"app-layout"),f(1,Ke,1,0,"app-loader"),c(2,"async"),f(3,at,3,3),n()),e&2&&(a(),_(w(2,1,o.isLoading$)?1:3))},dependencies:[pe,M,se,ce,ve,ue,N,de,$,G,U,A,ge,be,Ce],encapsulation:2})};export{Ae as OfferDetailsPageComponent};

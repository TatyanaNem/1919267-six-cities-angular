import{Ib as u,Jb as $,K as F,N as I,O as c,Rb as R,Sb as T,Yb as w,Zb as L,_b as y,a as s,b as f,fb as P,n as S,p as x,q as A,s as b,vb as a,w as h,wb as n}from"./chunk-YM7BC6NY.js";function k(t){return t.reduce((r,e)=>{let o=e.city.name;return o in r||(r[o]=[]),r[o].push(e),r},{})}function N(t){return t[Math.floor(Math.random()*t.length)]}function B(t,r){return r.rating-t.rating}function M(t,r){return t.price-r.price}function C(t,r){return r.price-t.price}var J={Popular:t=>t.slice(),"Price: high to low":t=>[...t].sort(C),"Price: low to high":t=>[...t].sort(M),"Top rated first":t=>[...t].sort(B)};function V(t,r){return new Date(r.date).getTime()-new Date(t.date).getTime()}var g=a("[Favorites Page] Get Favorites"),d=a("[Favorites Page] Get Favorites Success",n()),l=a("[Favorites Page] Get Favorites Failure",n()),E=a("[Favorites Page] Update Favorite Status",n()),O=a("[Favorites Page] Update Favorite Status Success",n()),H=a("[Favorites Page] Update Favorite Status Failure",n());var v=class t{constructor(r){this.http=r}getFavorites(){return this.http.get(`${R}/favorite`).pipe(x(T))}updateFavoriteStatus(r,e){return this.http.post(`${R}/favorite/${r}/${e}`,{}).pipe(x(T))}static \u0275fac=function(e){return new(e||t)(I(P))};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})};var U=class t{getFavorites$=w((r=c(L),e=c(v))=>r.pipe(y(g),b(()=>e.getFavorites().pipe(A(o=>d({favorites:o})),h(o=>S(l({error:o.message})))))));updateFavoriteStatus$=w((r=c(L),e=c(v))=>r.pipe(y(E),b(({id:o,status:m})=>e.updateFavoriteStatus(o,m).pipe(A(i=>O({offer:i,status:m})),h(i=>S(H({error:i})))))));static \u0275fac=function(e){return new(e||t)};static \u0275prov=F({token:t,factory:t.\u0275fac,providedIn:"root"})};var G={isLoading:!1,favorites:[],error:null},gt=$(G,u(g,t=>f(s({},t),{isLoading:!0})),u(d,(t,r)=>f(s({},t),{isLoading:!1,favorites:r.favorites})),u(l,(t,r)=>f(s({},t),{isLoading:!1,error:r.error})),u(O,(t,r)=>{let e=r.status===0,{id:o,isFavorite:m}=r.offer,i=t.favorites.map(p=>p.id===o?f(s({},p),{isFavorite:m}):p);return e?i=i.filter(p=>p.id!==o):i=[...i,r.offer],f(s({},t),{favorites:i})}));export{J as a,V as b,k as c,N as d,g as e,E as f,O as g,U as h,gt as i};

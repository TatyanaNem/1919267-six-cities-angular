import{$ as U,Aa as J,Ab as re,Bb as b,Db as g,Eb as oe,Fa as f,Ga as O,Ha as W,J as S,M as $,Mb as ie,N as z,Nb as ae,Pa as I,Qa as X,Ra as Y,S as G,T as j,Tb as ne,Ub as se,Vb as fe,W as N,a as c,aa as a,ab as Z,b as l,ca as K,cb as ee,da as u,ga as F,ia as Q,ka as h,kb as te,la as k,ma as V,n as B,p as L,pa as m,q as R,qa as q,qb as s,rb as p,s as D,ua as i,va as n,w as H,wa as d,ya as C}from"./chunk-RW7BJWYE.js";var _=class e{transform(t,o=5){return t?`${Math.round(t/o*100)}%`:"0%"}static \u0275fac=function(o){return new(o||e)};static \u0275pipe=F({name:"getRating",type:e,pure:!0})};var pe=class e{transform(t,o){return o>1?`${t}s`:t}static \u0275fac=function(o){return new(o||e)};static \u0275pipe=F({name:"pluralEnding",type:e,pure:!0})};function Ie(e){return e.reduce((t,o)=>{let r=o.city.name;return r in t||(t[r]=[]),t[r].push(o),t},{})}function be(e,t){return t.rating-e.rating}function Se(e,t){return e.price-t.price}function Fe(e,t){return t.price-e.price}var Re={Popular:e=>e.slice(),"Price: high to low":e=>[...e].sort(Fe),"Price: low to high":e=>[...e].sort(Se),"Top rated first":e=>[...e].sort(be)};function De(e,t){return new Date(t.date).getTime()-new Date(e.date).getTime()}var y=class e{block="place-card";size="small";isFavorite;updateFavoriteStatus=new N;bookmarkSize={small:{width:"18",height:"19"},large:{width:"31",height:"33"}};onBookmarkClickHandler(){this.updateFavoriteStatus.emit(!this.isFavorite)}static \u0275fac=function(o){return new(o||e)};static \u0275cmp=u({type:e,selectors:[["app-bookmark-button"]],inputs:{block:"block",size:"size",isFavorite:"isFavorite"},outputs:{updateFavoriteStatus:"updateFavoriteStatus"},decls:5,vars:7,consts:[["type","button",3,"click"],[0,"xlink","href","#icon-bookmark"],[1,"visually-hidden"]],template:function(o,r){o&1&&(i(0,"button",0),C("click",function(){return r.onBookmarkClickHandler()}),G(),i(1,"svg"),d(2,"use",1),n(),j(),i(3,"span",2),f(4),n()()),o&2&&(m(r.isFavorite?`${r.block}__bookmark-button button ${r.block}__bookmark-button--active`:`${r.block}__bookmark-button button`),a(),m(r.block+"__bookmark-icon"),h("width",r.bookmarkSize[r.size].width)("height",r.bookmarkSize[r.size].height),a(3),O(r.isFavorite?"In bookmarks":"To bookmarks"))},dependencies:[Z],encapsulation:2})};var w=class e{block="place-card";static \u0275fac=function(o){return new(o||e)};static \u0275cmp=u({type:e,selectors:[["app-premium-mark"]],inputs:{block:"block"},decls:3,vars:2,template:function(o,r){o&1&&(i(0,"div")(1,"span"),f(2,"Premium"),n()()),o&2&&m(r.block+"__mark")},encapsulation:2})};var P=s("[Main Offers Page] Get Offers"),x=s("[Main Offers Page] Get Offers Success",p()),A=s("[Main Offers Page] Get Offers Failure",p()),ce=s("[Main Offers Page] Set Current City",p()),M=s("[Offer] Update Favorite Status",p());var T=class e{constructor(t){this.http=t}getOffers(){return this.http.get(`${ie}/offers`).pipe(L(ae))}static \u0275fac=function(o){return new(o||e)($(ee))};static \u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"})};var ue=class e{getOffers$=ne((t=z(se),o=z(T))=>t.pipe(fe(P),D(()=>o.getOffers().pipe(R(r=>x({offers:r})),H(r=>B(A({error:r.message})))))));static \u0275fac=function(o){return new(o||e)};static \u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"})};var E=e=>e.OFFERS_DATA,he=b(E,e=>e.offers),Ce=b(E,e=>e.currentCity),ct=b(he,Ce,(e,t)=>e.filter(o=>o.city.name===t)),lt=b(E,e=>e.isLoading);var _e={isLoading:!1,offers:[],error:null,currentCity:"Paris"},kt=oe(_e,g(ce,(e,t)=>l(c({},e),{currentCity:t.city})),g(P,e=>l(c({},e),{isLoading:!0})),g(x,(e,t)=>l(c({},e),{isLoading:!1,offers:t.offers})),g(A,(e,t)=>l(c({},e),{isLoading:!1,error:t.error})),g(M,(e,t)=>l(c({},e),{offers:e.offers.map(o=>o.id===t.id?l(c({},o),{isFavorite:t.status}):o)})));var yt=s("[Favorites Page] Get Favorites"),wt=s("[Favorites Page] Get Favorites Success",p()),Pt=s("[Favorites Page] Get Favorites Failure",p()),de=s("[Favorites Page] Update Favorite Status",p());var ge=e=>["/offer",e];function Pe(e,t){e&1&&d(0,"app-premium-mark")}var ve=class e{constructor(t){this.store=t}offer;block="cities";size="large";imageSize={small:{width:"150",height:"110"},large:{width:"260",height:"200"}};updateFavoriteStatus(t){this.store.dispatch(M({status:t,id:this.offer.id})),this.store.dispatch(de({status:t,id:this.offer.id}))}static \u0275fac=function(o){return new(o||e)(K(re))};static \u0275cmp=u({type:e,selectors:[["app-offer-card"]],inputs:{offer:"offer",block:"block",size:"size"},decls:24,vars:23,consts:[[3,"routerLink"],[1,"place-card__image",3,"src","alt"],[1,"place-card__info"],[1,"place-card__price-wrapper"],[1,"place-card__price"],[1,"place-card__price-value"],[1,"place-card__price-text"],[3,"updateFavoriteStatus","isFavorite"],[1,"place-card__rating","rating"],[1,"place-card__stars","rating__stars"],[1,"visually-hidden"],[1,"place-card__name"],[1,"place-card__type"]],template:function(o,r){o&1&&(i(0,"article"),Q(1,Pe,1,0,"app-premium-mark"),i(2,"div")(3,"a",0),d(4,"img",1),n()(),i(5,"div",2)(6,"div",3)(7,"div",4)(8,"b",5),f(9),n(),i(10,"span",6),f(11,"/\xA0night"),n()(),i(12,"app-bookmark-button",7),C("updateFavoriteStatus",function(Oe){return r.updateFavoriteStatus(Oe)}),n()(),i(13,"div",8)(14,"div",9),d(15,"span"),X(16,"getRating"),i(17,"span",10),f(18,"Rating"),n()()(),i(19,"h2",11)(20,"a",0),f(21),n()(),i(22,"p",12),f(23),n()()()),o&2&&(m(`${r.block}__card place-card`),a(),q(r.offer.isPremium?1:-1),a(),m(`${r.block}__image-wrapper place-card__image-wrapper`),a(),k("routerLink",I(19,ge,r.offer.id)),a(),J("alt",r.offer.title),k("src",r.offer.previewImage,U),h("width",r.imageSize[r.size].width)("height",r.imageSize[r.size].height),a(5),W("\u20AC",r.offer.price,""),a(3),k("isFavorite",r.offer.isFavorite),a(3),V("width",Y(16,17,r.offer.rating)),a(5),k("routerLink",I(21,ge,r.offer.id)),a(),O(r.offer.title),a(2),O(r.offer.type))},dependencies:[_,y,w,te],encapsulation:2})};export{_ as a,pe as b,Re as c,De as d,Ie as e,y as f,w as g,P as h,ce as i,ue as j,ct as k,lt as l,kt as m,yt as n,wt as o,Pt as p,de as q,ve as r};

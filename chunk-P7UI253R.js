import{a as _e,b as Ie,c as Fe,e as Ee,g as Re,h as ke,k as Ae,l as Pe,m as De}from"./chunk-RBSCS3BJ.js";import{a as M,b as le,c as me,d as fe,e as de,f as ue}from"./chunk-LKSNXNGS.js";import{a as we,b as R,c as ge,d as Ce,e as he,f as be,g as ye,h as Se,i as xe,j as Oe}from"./chunk-VZBV3224.js";import{f as ce}from"./chunk-WPGPD6B2.js";import{a as ve}from"./chunk-5DGS6CYZ.js";import{Aa as g,Ba as C,Ca as r,Da as o,Ea as l,Fb as I,Ha as Z,Ja as D,Ka as _,Ma as s,Na as x,Oa as w,Pa as z,Pb as B,Qb as se,R as Y,S as q,T as J,Ua as f,Va as v,Wa as O,Za as ee,bb as T,cb as te,db as ie,dc as N,ea as S,eb as re,f as j,fa as n,gc as pe,ja as h,ka as d,mb as oe,ob as ne,pa as c,q as y,r as W,sa as K,ta as m,ua as A,ub as ae,v as X,va as Q,ya as u,za as P}from"./chunk-YM7BC6NY.js";function Me(t,i){t&1&&(r(0,"span",4),s(1," Pro "),o())}function $e(t,i){if(t&1&&(r(0,"div",0)(1,"div",1),l(2,"img",2),o(),r(3,"span",3),s(4),o(),c(5,Me,2,0,"span",4),o()),t&2){let e=_();n(),Q("offer__avatar-wrapper--pro",e.hostUser.isPro),n(),m("src",e.hostUser.avatarUrl,S)("alt",e.hostUser.name),n(2),w(" ",e.hostUser.name," "),n(),u(e.hostUser.isPro?5:-1)}}var $=class t{hostUser={avatarUrl:"",id:1,isPro:!1,name:""};static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-host-user"]],inputs:{hostUser:"hostUser"},decls:1,vars:1,consts:[[1,"offer__host-user","user"],[1,"offer__avatar-wrapper","user__avatar-wrapper"],["width","74","height","74",1,"offer__avatar","user__avatar",3,"src","alt"],[1,"offer__user-name"],[1,"offer__user-status"]],template:function(e,a){e&1&&c(0,$e,6,6,"div",0),e&2&&u(a.hostUser?0:-1)},encapsulation:2})};var Ue=(t,i)=>i.id;function Ge(t,i){if(t&1&&l(0,"app-offer-card",3),t&2){let e=i.$implicit;m("offer",e)("block","near-places")}}var U=class t{nearbyOffers=[];displayedOffers=ee(()=>this.nearbyOffers.slice(0,B));static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-near-places-block"]],inputs:{nearbyOffers:"nearbyOffers"},decls:6,vars:0,consts:[[1,"near-places","places"],[1,"near-places__title"],[1,"near-places__list","places__list"],[3,"offer","block"]],template:function(e,a){e&1&&(r(0,"section",0)(1,"h2",1),s(2,"Other places in the neighbourhood"),o(),r(3,"div",2),g(4,Ge,1,2,"app-offer-card",3,Ue),o()()),e&2&&(n(4),C(a.displayedOffers()))},dependencies:[de],encapsulation:2})};function Le(t,i){if(t&1&&(r(0,"div",2),l(1,"img",3),o()),t&2){let e=i.$implicit;n(),m("src",e,S)}}var G=class t{offerImages=[];static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-offer-gallery"]],inputs:{offerImages:"offerImages"},decls:4,vars:0,consts:[[1,"offer__gallery-container","container"],[1,"offer__gallery"],[1,"offer__image-wrapper"],["alt","Photo studio",1,"offer__image",3,"src"]],template:function(e,a){e&1&&(r(0,"div",0)(1,"div",1),g(2,Le,2,1,"div",2,P),o()()),e&2&&(n(2),C(a.offerImages))},encapsulation:2})};var Ve=(t,i)=>i.value;function He(t,i){if(t&1&&(l(0,"input",9),r(1,"label",10),J(),r(2,"svg",11),l(3,"use",12),o()()),t&2){let e=i.$implicit;m("value",e.value)("id",`${e.value}-stars`),n(),m("for",`${e.value}-stars`)("title",e.title)}}var L=class t{constructor(i,e){this.store=i;this.fb=e;this.reviewForm=this.fb.group({rating:this.fb.control("",[R.required]),comment:this.fb.control("",[R.required,R.minLength(50),R.maxLength(300)])})}offerId;reviewForm;ratingMap=[{title:"perfect",value:5},{title:"good",value:4},{title:"not bad",value:3},{title:"badly",value:2},{title:"terribly",value:1}];onSubmit(){this.reviewForm&&this.reviewForm.value&&(this.store.dispatch(Fe({id:this.offerId,review:{rating:Number(this.reviewForm.value.rating),comment:this.reviewForm.value.comment}})),this.reviewForm.reset({rating:0,review:""}))}static \u0275fac=function(e){return new(e||t)(h(I),h(xe))};static \u0275cmp=d({type:t,selectors:[["app-review-form"]],inputs:{offerId:"offerId"},decls:18,vars:2,consts:[["action","#","method","post",1,"reviews__form","form",3,"ngSubmit","formGroup"],["for","review",1,"reviews__label","form__label"],[1,"reviews__rating-form","form__rating"],["id","review","name","review","placeholder","Tell how was your stay, what you like and what can be improved","formControlName","comment",1,"reviews__textarea","form__textarea"],[1,"reviews__button-wrapper"],[1,"reviews__help"],[1,"reviews__star"],[1,"reviews__text-amount"],["type","submit",1,"reviews__submit","form__submit","button",3,"disabled"],["name","rating","type","radio","formControlName","rating",1,"form__rating-input","visually-hidden",3,"value","id"],[1,"reviews__rating-label","form__rating-label",3,"for","title"],["width","37","height","33",1,"form__star-image"],[0,"xlink","href","#icon-star"]],template:function(e,a){e&1&&(r(0,"form",0),D("ngSubmit",function(){return a.onSubmit()}),r(1,"label",1),s(2,"Your review"),o(),r(3,"div",2),g(4,He,4,4,null,null,Ve),o(),l(6,"textarea",3),r(7,"div",4)(8,"p",5),s(9," To submit review please make sure to set "),r(10,"span",6),s(11,"rating"),o(),s(12," and describe your stay with at least "),r(13,"b",7),s(14,"50 characters"),o(),s(15,". "),o(),r(16,"button",8),s(17,"Submit"),o()()()),e&2&&(m("formGroup",a.reviewForm),n(4),C(a.ratingMap),n(12),m("disabled",a.reviewForm.invalid))},dependencies:[Oe,he,we,be,ge,Ce,ye,Se],encapsulation:2})};var V=class t{review=null;static \u0275fac=function(e){return new(e||t)};static \u0275cmp=d({type:t,selectors:[["app-review-item"]],inputs:{review:"review"},decls:19,vars:16,consts:[[1,"reviews__item"],[1,"reviews__user","user"],[1,"reviews__avatar-wrapper","user__avatar-wrapper"],["width","54","height","54",1,"reviews__avatar","user__avatar",3,"src","alt"],[1,"reviews__user-name"],[1,"reviews__info"],[1,"reviews__rating","rating"],[1,"reviews__stars","rating__stars"],[1,"visually-hidden"],[1,"reviews__text"],[1,"reviews__time"]],template:function(e,a){e&1&&(r(0,"li",0)(1,"div",1)(2,"div",2),l(3,"img",3),o(),r(4,"span",4),s(5),o()(),r(6,"div",5)(7,"div",6)(8,"div",7),l(9,"span"),f(10,"getRating"),r(11,"span",8),s(12,"Rating"),o()()(),r(13,"p",9),s(14),o(),r(15,"time",10),f(16,"date"),s(17),f(18,"date"),o()()()),e&2&&(n(3),m("src",a.review==null||a.review.user==null?null:a.review.user.avatarUrl,S)("alt",a.review==null||a.review.user==null?null:a.review.user.name),n(2),w(" ",a.review==null||a.review.user==null?null:a.review.user.name," "),n(4),A("width",v(10,8,a.review==null?null:a.review.rating)),n(5),w(" ",a.review==null?null:a.review.comment," "),n(),K("datetime",O(16,10,a.review==null?null:a.review.date,"yyyy-MM-dd")),n(2),x(O(18,13,a.review==null?null:a.review.date,"MMMM y")))},dependencies:[M,ie],encapsulation:2})};var je=(t,i)=>i.id;function We(t,i){if(t&1&&l(0,"app-review-item",5),t&2){let e=i.$implicit;m("review",e)}}function Xe(t,i){if(t&1&&(r(0,"ul",3),g(1,We,1,1,"app-review-item",5,je),o()),t&2){let e=_();n(),C(e)}}function Ye(t,i){if(t&1&&l(0,"app-review-form",4),t&2){let e=_(2);m("offerId",e.offerId)}}function qe(t,i){if(t&1&&(r(0,"section",0)(1,"h2",1),s(2,"Reviews \xB7 "),r(3,"span",2),s(4),o()(),c(5,Xe,3,0,"ul",3)(6,Ye,1,1,"app-review-form",4),f(7,"async"),o()),t&2){let e=i,a=_();n(4),x(e.length>10?`${a.reviewsToShow} of ${e.length}`:e.length),n(),u(e.length?5:-1),n(),u(v(7,3,a.isAuth$)?6:-1)}}var H=class t{constructor(i){this.store=i;this.reviews$=this.store.select(Ee),this.isAuth$=this.store.select(N).pipe(y(e=>e==="AUTH"))}offerId="";reviews$;reviewsToShow=se;isAuth$;ngOnInit(){this.store.dispatch(Ie({id:this.offerId}))}static \u0275fac=function(e){return new(e||t)(h(I))};static \u0275cmp=d({type:t,selectors:[["app-reviews-block"]],inputs:{offerId:"offerId"},decls:2,vars:3,consts:[[1,"offer__reviews","reviews"],[1,"reviews__title"],[1,"reviews__amount"],[1,"reviews__list"],[3,"offerId"],[3,"review"]],template:function(e,a){if(e&1&&(c(0,qe,8,5,"section",0),f(1,"async")),e&2){let p;u((p=v(1,1,a.reviews$))?0:-1,p)}},dependencies:[V,L,T],encapsulation:2})};function Je(t,i){t&1&&l(0,"app-loader")}function Ke(t,i){t&1&&l(0,"app-premium-mark",6),t&2&&m("block","offer")}function Qe(t,i){if(t&1&&(r(0,"li",24),s(1),o()),t&2){let e=i.$implicit;n(),w(" ",e," ")}}function Ze(t,i){if(t&1&&l(0,"app-reviews-block",30),t&2){let e=_(3);m("offerId",e.offerId)}}function et(t,i){if(t&1&&l(0,"app-map",31),t&2){let e=_();m("offers",i)("city",e.city.location)("activeOfferId",e.id)}}function tt(t,i){t&1&&(r(0,"div",32),l(1,"app-near-places-block",33),o()),t&2&&(n(),m("nearbyOffers",i))}function it(t,i){if(t&1){let e=Z();r(0,"main",0)(1,"section",2),l(2,"app-offer-gallery",3),r(3,"div",4)(4,"div",5),c(5,Ke,1,1,"app-premium-mark",6),r(6,"div",7)(7,"h1",8),s(8),o(),r(9,"app-bookmark-button",9),D("updateFavoriteStatus",function(p){Y(e);let b=_(2);return q(b.updateFavoriteStatus(p))}),o()(),r(10,"div",10)(11,"div",11),l(12,"span"),f(13,"getRating"),r(14,"span",12),s(15,"Rating"),o()(),r(16,"span",13),s(17),o()(),r(18,"ul",14)(19,"li",15),s(20),f(21,"titlecase"),o(),r(22,"li",16),s(23),f(24,"pluralEnding"),o(),r(25,"li",17),s(26),f(27,"pluralEnding"),o()(),r(28,"div",18)(29,"b",19),s(30),o(),r(31,"span",20),s(32,"\xA0night"),o()(),r(33,"div",21)(34,"h2",22),s(35,"What's inside"),o(),r(36,"ul",23),g(37,Qe,2,1,"li",24,P),o()(),r(39,"div",25)(40,"h2",26),s(41,"Meet the host"),o(),l(42,"app-host-user",27),r(43,"div",28)(44,"p",29),s(45),o()()(),c(46,Ze,1,1,"app-reviews-block",30),o()(),c(47,et,1,3,"app-map",31),f(48,"async"),o(),c(49,tt,2,1,"div",32),f(50,"async"),o()}if(t&2){let e,a,p=i,b=_(2);n(2),m("offerImages",p.images),n(3),u(p.isPremium?5:-1),n(3),w(" ",p.title," "),n(),m("block","offer")("size","large")("isFavorite",p.isFavorite),n(3),A("width",v(13,20,p.rating)),n(5),x(p.rating),n(3),w(" ",v(21,22,p.type)," "),n(3),z(" ",p.bedrooms," ",O(24,24,"Bedroom",p.bedrooms)," "),n(3),z(" Max ",p.maxAdults," ",O(27,27,"adult",p.maxAdults)," "),n(4),w("\u20AC",p.price,""),n(7),C(p.goods),n(5),m("hostUser",p.host),n(3),w(" ",p.description," "),n(),u(b.offerId?46:-1),n(),u((e=v(48,30,b.offersForMap$))?47:-1,e),n(2),u((a=v(50,32,b.nearbyOffers$))?49:-1,a)}}function rt(t,i){t&1&&l(0,"app-not-found-block",1),t&2&&m("type","offer")}function ot(t,i){if(t&1&&(c(0,it,51,34,"main",0),f(1,"async"),c(2,rt,1,1,"app-not-found-block",1)),t&2){let e,a=_();u((e=v(1,1,a.currentOffer$))?0:2,e)}}var Ne=class t{constructor(i,e,a){this.route=i;this.store=e;this.router=a;this.currentOffer$=this.store.select(Ae),this.nearbyOffers$=this.store.select(Pe),this.isLoading$=this.store.select(De),this.isAuth=ae(this.store.select(N).pipe(y(p=>p==="AUTH")),{initialValue:!1}),this.offersForMap$=W([this.currentOffer$,this.nearbyOffers$.pipe(y(p=>p.slice(0,B)))]).pipe(y(([p,b])=>{let k=[];return p&&k.push(p),k=k.concat(b),k}))}offerId="";currentOffer$;nearbyOffers$;isLoading$;offersForMap$;isAuth;subscription=new j;ngOnInit(){this.subscription=this.route.paramMap.pipe(X(i=>!!i.get("offerId")),y(i=>i.get("offerId")??"")).subscribe(i=>{this.offerId=i,this.store.dispatch(Re({id:i})),this.store.dispatch(ke({id:i}))})}ngOnDestroy(){this.subscription.unsubscribe()}updateFavoriteStatus(i){if(!this.isAuth()){this.router.navigate(["login"]);return}this.store.dispatch(ce({status:Number(i),id:this.offerId}))}static \u0275fac=function(e){return new(e||t)(h(oe),h(I),h(ne))};static \u0275cmp=d({type:t,selectors:[["app-offer-page"]],decls:4,vars:3,consts:[[1,"page__main","page__main--offer"],[3,"type"],[1,"offer"],[3,"offerImages"],[1,"offer__container","container"],[1,"offer__wrapper"],[3,"block"],[1,"offer__name-wrapper"],[1,"offer__name"],[3,"updateFavoriteStatus","block","size","isFavorite"],[1,"offer__rating","rating"],[1,"offer__stars","rating__stars"],[1,"visually-hidden"],[1,"offer__rating-value","rating__value"],[1,"offer__features"],[1,"offer__feature","offer__feature--entire"],[1,"offer__feature","offer__feature--bedrooms"],[1,"offer__feature","offer__feature--adults"],[1,"offer__price"],[1,"offer__price-value"],[1,"offer__price-text"],[1,"offer__inside"],[1,"offer__inside-title"],[1,"offer__inside-list"],[1,"offer__inside-item"],[1,"offer__host"],[1,"offer__host-title"],[3,"hostUser"],[1,"offer__description"],[1,"offer__text"],[3,"offerId"],["block","offer",3,"offers","city","activeOfferId"],[1,"container"],[3,"nearbyOffers"]],template:function(e,a){e&1&&(r(0,"app-layout"),c(1,Je,1,0,"app-loader"),f(2,"async"),c(3,ot,3,3),o()),e&2&&(n(),u(v(2,1,a.isLoading$)?1:3))},dependencies:[re,T,te,pe,me,fe,M,le,$,H,G,U,ue,ve,_e],encapsulation:2})};export{Ne as OfferDetailsPageComponent};
